# ğŸ“± KTC Logistics Driver Mobile App 2025

**FastRoute** lÃ  á»©ng dá»¥ng di Ä‘á»™ng dÃ nh cho tÃ i xáº¿ giao hÃ ng, phÃ¡t triá»ƒn báº±ng Flutter vá»›i giao diá»‡n **Spatial UI** hiá»‡n Ä‘áº¡i: bá»‘ cá»¥c Ä‘a táº§ng, hiá»‡u á»©ng chuyá»ƒn Ä‘á»™ng, hiá»ƒn thá»‹ trá»±c quan báº£n Ä‘á»“ vÃ  thÃ´ng tin theo ngá»¯ cáº£nh. ÄÆ°á»£c xÃ¢y dá»±ng theo nguyÃªn táº¯c **Clean Architecture**, á»©ng dá»¥ng dá»… báº£o trÃ¬, má»Ÿ rá»™ng vÃ  test, vá»›i sá»± phÃ¢n tÃ¡ch rÃµ rÃ ng giá»¯a UI, business logic vÃ  data layers. á»¨ng dá»¥ng tá»‘i Æ°u cho thao tÃ¡c ngoÃ i trá»i, giÃºp tÃ i xáº¿ táº­p trung vÃ  xá»­ lÃ½ Ä‘Æ¡n hÃ ng nhanh chÃ³ng, an toÃ n.

## ğŸš€ TÃ­nh nÄƒng chÃ­nh

### ğŸ“¦ Quáº£n lÃ½ Ä‘Æ¡n hÃ ng

- Nháº­n Ä‘Æ¡n hÃ ng má»›i theo thá»i gian thá»±c
- Xem chi tiáº¿t thÃ´ng tin giao hÃ ng
- Cáº­p nháº­t tráº¡ng thÃ¡i Ä‘Æ¡n hÃ ng (Ä‘ang giao, hoÃ n thÃ nh)
- Lá»‹ch sá»­ cÃ¡c chuyáº¿n giao hÃ ng

### ğŸ—ºï¸ Navigation & Maps

- TÃ­ch há»£p MapBox vá»›i GPS tracking
- Tá»‘i Æ°u tuyáº¿n Ä‘Æ°á»ng thá»i gian thá»±c
- Hiá»ƒn thá»‹ vá»‹ trÃ­ pickup vÃ  delivery
- Tuá»³ chá»‰nh style báº£n Ä‘á»“ vÃ  Ä‘Æ°á»ng Ä‘i
- Äá»‹nh vá»‹ chÃ­nh xÃ¡c vá»‹ trÃ­ tÃ i xáº¿ vá»›i CustomPosition
- TÃ­nh toÃ¡n quÃ£ng Ä‘Æ°á»ng vÃ  thá»i gian di chuyá»ƒn
- Hiá»ƒn thá»‹ hÆ°á»›ng dáº«n chá»‰ Ä‘Æ°á»ng chi tiáº¿t (turn-by-turn)

### ğŸ“Š Data Visualization & Analytics

- **Dashboard Analytics**: Hiá»ƒn thá»‹ tá»•ng quan hiá»‡u suáº¥t giao hÃ ng
- **Biá»ƒu Ä‘á»“ khu vá»±c (Area Chart)**: Theo dÃµi xu hÆ°á»›ng giao hÃ ng theo thá»i gian
- **Biá»ƒu Ä‘á»“ cá»™t (Bar Chart)**: PhÃ¢n tÃ­ch sá»‘ lÆ°á»£ng giao hÃ ng theo ngÃ y trong tuáº§n
- **Biá»ƒu Ä‘á»“ trÃ²n (Pie Chart)**: Trá»±c quan hÃ³a phÃ¢n phá»‘i loáº¡i hÃ¬nh giao hÃ ng
- **Biá»ƒu Ä‘á»“ phÃ¢n tÃ¡n (Scatter Chart)**: PhÃ¢n tÃ­ch má»‘i quan há»‡ giá»¯a quÃ£ng Ä‘Æ°á»ng vÃ  thá»i gian giao hÃ ng
- **Biá»ƒu Ä‘á»“ bong bÃ³ng (Bubble Chart)**: So sÃ¡nh hiá»‡u suáº¥t giao hÃ ng giá»¯a cÃ¡c khu vá»±c
- **Biá»ƒu Ä‘á»“ radar (Radar Chart)**: ÄÃ¡nh giÃ¡ hiá»‡u suáº¥t Ä‘a chiá»u cá»§a cÃ¡c loáº¡i hÃ¬nh giao hÃ ng
- **Cháº¿ Ä‘á»™ sÃ¡ng/tá»‘i**: Táº¥t cáº£ biá»ƒu Ä‘á»“ Ä‘á»u tÆ°Æ¡ng thÃ­ch vá»›i cháº¿ Ä‘á»™ giao diá»‡n sÃ¡ng vÃ  tá»‘i

## CÃ¡c mÃ n hÃ¬nh chÃ­nh

### ğŸ  Dashboard Screen

- **Overview**: Hiá»ƒn thá»‹ tá»•ng quan hiá»‡u suáº¥t tÃ i xáº¿
- **Key Metrics**: Sá»‘ Ä‘Æ¡n hoÃ n thÃ nh, tá»· lá»‡ Ä‘Ãºng giá», quÃ£ng Ä‘Æ°á»ng trung bÃ¬nh, Ä‘Ã¡nh giÃ¡
- **Upcoming Deliveries**: Danh sÃ¡ch Ä‘Æ¡n hÃ ng sáº¯p tá»›i
- **Charts**: Biá»ƒu Ä‘á»“ khu vá»±c vÃ  cá»™t cho phÃ¢n tÃ­ch xu hÆ°á»›ng giao hÃ ng

### ğŸ—ºï¸ Route Map Screen

- **MapBox Integration**: Báº£n Ä‘á»“ tÆ°Æ¡ng tÃ¡c vá»›i nhiá»u lá»›p dá»¯ liá»‡u
- **Route Optimization**: TÃ­nh toÃ¡n vÃ  hiá»ƒn thá»‹ tuyáº¿n Ä‘Æ°á»ng tá»‘i Æ°u
- **Turn-by-turn Navigation**: HÆ°á»›ng dáº«n chi tiáº¿t tá»«ng Ä‘oáº¡n Ä‘Æ°á»ng
- **Custom Position Handling**: Xá»­ lÃ½ vÃ  hiá»ƒn thá»‹ vá»‹ trÃ­ chÃ­nh xÃ¡c vá»›i kiá»ƒu dá»¯ liá»‡u tÃ¹y chá»‰nh
- **Multiple Stops**: Há»— trá»£ Ä‘a Ä‘iá»ƒm giao hÃ ng trÃªn cÃ¹ng tuyáº¿n Ä‘Æ°á»ng

### ï¿½ Analytics Screen

- **Weekly Performance**: Biá»ƒu Ä‘á»“ area chart cho xu hÆ°á»›ng theo thá»i gian
- **Daily Analysis**: Biá»ƒu Ä‘á»“ cá»™t phÃ¢n tÃ­ch theo ngÃ y trong tuáº§n
- **Delivery Distribution**: Biá»ƒu Ä‘á»“ trÃ²n phÃ¢n loáº¡i cÃ¡c chuyáº¿n giao hÃ ng
- **Efficiency Analysis**: Biá»ƒu Ä‘á»“ scatter chart so sÃ¡nh quÃ£ng Ä‘Æ°á»ng vÃ  thá»i gian
- **Regional Performance**: Biá»ƒu Ä‘á»“ bubble chart phÃ¢n tÃ­ch theo khu vá»±c
- **Service Comparison**: Biá»ƒu Ä‘á»“ radar Ä‘Ã¡nh giÃ¡ cÃ¡c loáº¡i hÃ¬nh dá»‹ch vá»¥ giao hÃ ng
- **Dark/Light Mode**: Tá»± Ä‘á»™ng Ä‘iá»u chá»‰nh hiá»ƒn thá»‹ theo cháº¿ Ä‘á»™ cá»§a há»‡ thá»‘ng

### ï¿½ Delivery Detail Screen

- **Package Information**: Chi tiáº¿t Ä‘Æ¡n hÃ ng
- **Status Management**: Cáº­p nháº­t tráº¡ng thÃ¡i giao hÃ ng
- **Customer Interaction**: Gá»i Ä‘iá»‡n, nháº¯n tin vá»›i khÃ¡ch hÃ ng
- **Proof of Delivery**: Chá»¥p áº£nh, láº¥y chá»¯ kÃ½ xÃ¡c nháº­n
- **Special Instructions**: Hiá»ƒn thá»‹ yÃªu cáº§u Ä‘áº·c biá»‡t cá»§a Ä‘Æ¡n hÃ ng

### ğŸ‘¤ Profile & Settings

- **Driver Information**: ThÃ´ng tin cÃ¡ nhÃ¢n tÃ i xáº¿
- **Vehicle Details**: ThÃ´ng tin phÆ°Æ¡ng tiá»‡n
- **Performance Stats**: Thá»‘ng kÃª hiá»‡u suáº¥t lÃ m viá»‡c
- **App Settings**: CÃ i Ä‘áº·t ngÃ´n ngá»¯, thÃ´ng bÃ¡o, theme

## ğŸ“Š Data Visualization Components

á»¨ng dá»¥ng tÃ­ch há»£p nhiá»u loáº¡i biá»ƒu Ä‘á»“ Ä‘á»ƒ trá»±c quan hÃ³a dá»¯ liá»‡u giao hÃ ng, giÃºp tÃ i xáº¿ theo dÃµi hiá»‡u suáº¥t vÃ  tá»‘i Æ°u hÃ³a cÃ´ng viá»‡c:

### ğŸŒŠ Area Chart

- **DeliveryAreaChart**: Hiá»ƒn thá»‹ xu hÆ°á»›ng giao hÃ ng theo thá»i gian
- **TÃ­nh nÄƒng**: ÄÆ°á»ng cong mÆ°á»£t mÃ , vÃ¹ng gradient, tÆ°Æ¡ng thÃ­ch dark/light mode
- **ThÃ´ng sá»‘ hiá»ƒn thá»‹**: Sá»‘ lÆ°á»£ng giao hÃ ng theo ngÃ y trong tuáº§n
- **Use case**: PhÃ¢n tÃ­ch xu hÆ°á»›ng, phÃ¡t hiá»‡n máº«u hÃ¬nh theo thá»i gian

### ğŸ“Š Bar Chart

- **DeliveryBarChart**: So sÃ¡nh sá»‘ lÆ°á»£ng giao hÃ ng theo ngÃ y trong tuáº§n
- **TÃ­nh nÄƒng**: Thanh gradient, tÆ°Æ¡ng tÃ¡c tooltip, hiá»ƒn thá»‹ giÃ¡ trá»‹
- **ThÃ´ng sá»‘ hiá»ƒn thá»‹**: Sá»‘ lÆ°á»£ng giao hÃ ng má»—i ngÃ y
- **Use case**: So sÃ¡nh hiá»‡u suáº¥t giá»¯a cÃ¡c ngÃ y, xÃ¡c Ä‘á»‹nh ngÃ y cao Ä‘iá»ƒm/tháº¥p Ä‘iá»ƒm

### ğŸ© Pie Chart

- **DeliveryTypePieChart**: PhÃ¢n phá»‘i cÃ¡c loáº¡i giao hÃ ng
- **TÃ­nh nÄƒng**: Sections Ä‘á»™ng, tÆ°Æ¡ng tÃ¡c tooltip, hiá»ƒn thá»‹ pháº§n trÄƒm
- **ThÃ´ng sá»‘ hiá»ƒn thá»‹**: Tá»· lá»‡ pháº§n trÄƒm cá»§a tá»«ng loáº¡i giao hÃ ng
- **Use case**: PhÃ¢n tÃ­ch cÆ¡ cáº¥u giao hÃ ng, so sÃ¡nh loáº¡i hÃ¬nh dá»‹ch vá»¥

### ğŸ”µ Scatter Chart

- **DeliveryScatterChart**: PhÃ¢n tÃ­ch má»‘i quan há»‡ giá»¯a khoáº£ng cÃ¡ch vÃ  thá»i gian
- **TÃ­nh nÄƒng**: KÃ­ch thÆ°á»›c Ä‘iá»ƒm Ä‘á»™ng (thá»ƒ hiá»‡n kÃ­ch thÆ°á»›c gÃ³i hÃ ng), tooltip chi tiáº¿t
- **ThÃ´ng sá»‘ hiá»ƒn thá»‹**: Khoáº£ng cÃ¡ch (km), thá»i gian (phÃºt), kÃ­ch thÆ°á»›c gÃ³i hÃ ng
- **Use case**: PhÃ¢n tÃ­ch hiá»‡u quáº£ giao hÃ ng, xÃ¡c Ä‘á»‹nh outliers

### ğŸ«§ Bubble Chart (Custom Scatter)

- **DeliveryBubbleChart**: So sÃ¡nh hiá»‡u suáº¥t giao hÃ ng giá»¯a cÃ¡c khu vá»±c
- **TÃ­nh nÄƒng**: Bong bÃ³ng kÃ­ch thÆ°á»›c Ä‘á»™ng, tooltip thÃ´ng tin, tÆ°Æ¡ng tÃ¡c hover
- **ThÃ´ng sá»‘ hiá»ƒn thá»‹**: Khoáº£ng cÃ¡ch trung bÃ¬nh, tá»· lá»‡ Ä‘Ãºng giá», sá»‘ lÆ°á»£ng giao hÃ ng
- **Use case**: So sÃ¡nh hiá»‡u suáº¥t giá»¯a cÃ¡c khu vá»±c Ä‘á»‹a lÃ½

### ğŸ”® Radar Chart

- **DeliveryRadarChart**: ÄÃ¡nh giÃ¡ Ä‘a chiá»u cÃ¡c loáº¡i hÃ¬nh dá»‹ch vá»¥ giao hÃ ng
- **TÃ­nh nÄƒng**: Hiá»ƒn thá»‹ Ä‘a metric, tÆ°Æ¡ng tÃ¡c chá»n loáº¡i dá»‹ch vá»¥, legend
- **ThÃ´ng sá»‘ hiá»ƒn thá»‹**: Tá»‘c Ä‘á»™, Ä‘á»™ chÃ­nh xÃ¡c, chi phÃ­, pháº¡m vi, sá»± hÃ i lÃ²ng cá»§a khÃ¡ch hÃ ng
- **Use case**: So sÃ¡nh toÃ n diá»‡n hiá»‡u suáº¥t cá»§a cÃ¡c loáº¡i dá»‹ch vá»¥ giao hÃ ng

### ğŸ¨ Thiáº¿t káº¿ vÃ  tÃ­ch há»£p

- **Responsive**: Tá»± Ä‘á»™ng Ä‘iá»u chá»‰nh kÃ­ch thÆ°á»›c theo thiáº¿t bá»‹
- **Theme Support**: TÆ°Æ¡ng thÃ­ch Ä‘áº§y Ä‘á»§ vá»›i cháº¿ Ä‘á»™ sÃ¡ng/tá»‘i
- **Interaction**: Tooltips, hover effects, vÃ  animations
- **Performance**: Tá»‘i Æ°u hÃ³a hiá»‡u suáº¥t vá»›i Flutter
- **Integration**: TÃ­ch há»£p liá»n máº¡ch vá»›i há»‡ thá»‘ng analytics

---

## ğŸ› ï¸ Tech Stack

### Frontend

- **Flutter**: 3.32.8 (latest stable)
- **Dart**: 3.8.1
- **State Management**: BLoC Pattern
- **UI Components**: Material Design 3
- **Charts**: fl_chart library (3.0.0+)
- **Spatial UI**: Custom implementation cá»§a Material 3 vá»›i hiá»‡u á»©ng depth vÃ  layering

### Backend Integration

- **HTTP Client**: Dart HTTP package
- **Real-time**: Socket.IO client
- **Caching**: Flutter Secure Storage
- **Image Handling**: Image Picker
- **Notifications**: Firebase Cloud Messaging (táº¡m thá»i)

### Maps & Location

- **MapBox**: MapBox Flutter SDK
- **GPS**: Geolocator package
- **Geocoding**: Geocoding package
- **Permissions**: Permission Handler

### Android Configuration

- **SDK**: 35 (Android 14)
- **Java**: 21 (LTS)
- **Gradle**: 8.14.3
- **Min SDK**: 24 (Android 7.0)

---

## ğŸ›ï¸ Clean Architecture Implementation

á»¨ng dá»¥ng Ä‘Æ°á»£c xÃ¢y dá»±ng theo **Clean Architecture**, giÃºp táº¡o ra má»™t codebase dá»… maintain, test vÃ  má»Ÿ rá»™ng. Kiáº¿n trÃºc nÃ y chia á»©ng dá»¥ng thÃ nh 3 táº§ng chÃ­nh:

### ğŸ¯ Domain Layer

Táº§ng core chá»©a business logic, hoÃ n toÃ n Ä‘á»™c láº­p vá»›i framework:
- **Models**: Entities vÃ  business objects
- **Repository Interfaces**: Contracts cho data operations
- **Use Cases**: Business rules cá»¥ thá»ƒ
- **BLoC**: Business Logic Components

### ğŸ“Š Data Layer

Táº§ng xá»­ lÃ½ dá»¯ liá»‡u tá»« external sources:
- **Repository Implementations**: Concrete implementations cá»§a domain interfaces
- **Data Sources**: Remote (API) vÃ  local (cache, database)
- **DTOs**: Data Transfer Objects vÃ  mappers

### ğŸ¨ Presentation Layer

Táº§ng giao diá»‡n ngÆ°á»i dÃ¹ng:
- **Screens & Pages**: UI cá»§a á»©ng dá»¥ng
- **Widgets**: Reusable UI components
- **State Management**: BLoC providers vÃ  consumers
- **Chart Components**: CÃ¡c biá»ƒu Ä‘á»“ dá»¯ liá»‡u Ä‘Æ°á»£c phÃ¡t triá»ƒn vá»›i fl_chart
- **Spatial UI**: Design system theo nguyÃªn táº¯c Ä‘a lá»›p, tÆ°Æ¡ng thÃ­ch dark/light mode

### ï¿½ Data Flow & Dependency Injection

**Flow**: UI â†’ BLoC â†’ Domain (Use Cases, Repository Interfaces) â†’ Data (Repository Implementations) â†’ External Sources

**Dependency Inversion**: Sá»­ dá»¥ng GetIt service locator Ä‘á»ƒ Ä‘áº£m báº£o Domain layer khÃ´ng phá»¥ thuá»™c vÃ o implementation details

**Benefits**:
- **Testability**: Má»—i layer cÃ³ thá»ƒ test independently
- **Flexibility**: Dá»… thay Ä‘á»•i UI/data sources mÃ  khÃ´ng áº£nh hÆ°á»Ÿng business logic
- **Maintainability**: Code organization rÃµ rÃ ng
- **Independence**: Business logic khÃ´ng phá»¥ thuá»™c framework

---

## ï¿½ Data Visualization Components

á»¨ng dá»¥ng tÃ­ch há»£p nhiá»u loáº¡i biá»ƒu Ä‘á»“ Ä‘á»ƒ trá»±c quan hÃ³a dá»¯ liá»‡u giao hÃ ng, giÃºp tÃ i xáº¿ theo dÃµi hiá»‡u suáº¥t vÃ  tá»‘i Æ°u hÃ³a cÃ´ng viá»‡c:

### ï¿½ Area Chart

- **DeliveryAreaChart**: Hiá»ƒn thá»‹ xu hÆ°á»›ng giao hÃ ng theo thá»i gian
- **TÃ­nh nÄƒng**: ÄÆ°á»ng cong mÆ°á»£t mÃ , vÃ¹ng gradient, tÆ°Æ¡ng thÃ­ch dark/light mode
- **ThÃ´ng sá»‘ hiá»ƒn thá»‹**: Sá»‘ lÆ°á»£ng giao hÃ ng theo ngÃ y trong tuáº§n
- **Use case**: PhÃ¢n tÃ­ch xu hÆ°á»›ng, phÃ¡t hiá»‡n máº«u hÃ¬nh theo thá»i gian

### ï¿½ Bar Chart

- **DeliveryBarChart**: So sÃ¡nh sá»‘ lÆ°á»£ng giao hÃ ng theo ngÃ y trong tuáº§n
- **TÃ­nh nÄƒng**: Thanh gradient, tÆ°Æ¡ng tÃ¡c tooltip, hiá»ƒn thá»‹ giÃ¡ trá»‹
- **ThÃ´ng sá»‘ hiá»ƒn thá»‹**: Sá»‘ lÆ°á»£ng giao hÃ ng má»—i ngÃ y
- **Use case**: So sÃ¡nh hiá»‡u suáº¥t giá»¯a cÃ¡c ngÃ y, xÃ¡c Ä‘á»‹nh ngÃ y cao Ä‘iá»ƒm/tháº¥p Ä‘iá»ƒm

### ğŸ© Pie Chart

- **DeliveryTypePieChart**: PhÃ¢n phá»‘i cÃ¡c loáº¡i giao hÃ ng
- **TÃ­nh nÄƒng**: Sections Ä‘á»™ng, tÆ°Æ¡ng tÃ¡c tooltip, hiá»ƒn thá»‹ pháº§n trÄƒm
- **ThÃ´ng sá»‘ hiá»ƒn thá»‹**: Tá»· lá»‡ pháº§n trÄƒm cá»§a tá»«ng loáº¡i giao hÃ ng
- **Use case**: PhÃ¢n tÃ­ch cÆ¡ cáº¥u giao hÃ ng, so sÃ¡nh loáº¡i hÃ¬nh dá»‹ch vá»¥

### ï¿½ Scatter Chart

- **DeliveryScatterChart**: PhÃ¢n tÃ­ch má»‘i quan há»‡ giá»¯a khoáº£ng cÃ¡ch vÃ  thá»i gian
- **TÃ­nh nÄƒng**: KÃ­ch thÆ°á»›c Ä‘iá»ƒm Ä‘á»™ng (thá»ƒ hiá»‡n kÃ­ch thÆ°á»›c gÃ³i hÃ ng), tooltip chi tiáº¿t
- **ThÃ´ng sá»‘ hiá»ƒn thá»‹**: Khoáº£ng cÃ¡ch (km), thá»i gian (phÃºt), kÃ­ch thÆ°á»›c gÃ³i hÃ ng
- **Use case**: PhÃ¢n tÃ­ch hiá»‡u quáº£ giao hÃ ng, xÃ¡c Ä‘á»‹nh outliers

### ğŸ«§ Bubble Chart (Custom Scatter)

- **DeliveryBubbleChart**: So sÃ¡nh hiá»‡u suáº¥t giao hÃ ng giá»¯a cÃ¡c khu vá»±c
- **TÃ­nh nÄƒng**: Bong bÃ³ng kÃ­ch thÆ°á»›c Ä‘á»™ng, tooltip thÃ´ng tin, tÆ°Æ¡ng tÃ¡c hover
- **ThÃ´ng sá»‘ hiá»ƒn thá»‹**: Khoáº£ng cÃ¡ch trung bÃ¬nh, tá»· lá»‡ Ä‘Ãºng giá», sá»‘ lÆ°á»£ng giao hÃ ng
- **Use case**: So sÃ¡nh hiá»‡u suáº¥t giá»¯a cÃ¡c khu vá»±c Ä‘á»‹a lÃ½

### ï¿½ Radar Chart

- **DeliveryRadarChart**: ÄÃ¡nh giÃ¡ Ä‘a chiá»u cÃ¡c loáº¡i hÃ¬nh dá»‹ch vá»¥ giao hÃ ng
- **TÃ­nh nÄƒng**: Hiá»ƒn thá»‹ Ä‘a metric, tÆ°Æ¡ng tÃ¡c chá»n loáº¡i dá»‹ch vá»¥, legend
- **ThÃ´ng sá»‘ hiá»ƒn thá»‹**: Tá»‘c Ä‘á»™, Ä‘á»™ chÃ­nh xÃ¡c, chi phÃ­, pháº¡m vi, sá»± hÃ i lÃ²ng cá»§a khÃ¡ch hÃ ng
- **Use case**: So sÃ¡nh toÃ n diá»‡n hiá»‡u suáº¥t cá»§a cÃ¡c loáº¡i dá»‹ch vá»¥ giao hÃ ng

### ğŸ¨ Thiáº¿t káº¿ vÃ  tÃ­ch há»£p

- **Responsive**: Tá»± Ä‘á»™ng Ä‘iá»u chá»‰nh kÃ­ch thÆ°á»›c theo thiáº¿t bá»‹
- **Theme Support**: TÆ°Æ¡ng thÃ­ch Ä‘áº§y Ä‘á»§ vá»›i cháº¿ Ä‘á»™ sÃ¡ng/tá»‘i
- **Interaction**: Tooltips, hover effects, vÃ  animations
- **Performance**: Tá»‘i Æ°u hÃ³a hiá»‡u suáº¥t vá»›i Flutter
- **Integration**: TÃ­ch há»£p liá»n máº¡ch vá»›i há»‡ thá»‘ng analytics

---

## ğŸ—ºï¸ Cáº£i tiáº¿n Map vÃ  Custom Position

Äá»ƒ giáº£i quyáº¿t váº¥n Ä‘á» xung Ä‘á»™t giá»¯a cÃ¡c kiá»ƒu dá»¯ liá»‡u vá»‹ trÃ­, á»©ng dá»¥ng Ä‘Ã£ triá»ƒn khai `CustomPosition` class:

### CustomPosition Class

```dart
class CustomPosition {
  final double latitude;
  final double longitude;
  final double altitude;
  final double accuracy;
  final double heading;
  final double speed;
  final double speedAccuracy;
  final DateTime timestamp;

  CustomPosition({
    required this.latitude,
    required this.longitude,
    this.altitude = 0.0,
    this.accuracy = 0.0,
    this.heading = 0.0,
    this.speed = 0.0,
    this.speedAccuracy = 0.0,
    DateTime? timestamp,
  }) : timestamp = timestamp ?? DateTime.now();

  // Conversion from geolocator Position
  factory CustomPosition.fromPosition(position) {
    return CustomPosition(
      latitude: position.latitude,
      longitude: position.longitude,
      altitude: position.altitude,
      accuracy: position.accuracy,
      heading: position.heading,
      speed: position.speed,
      speedAccuracy: position.speedAccuracy,
      timestamp: position.timestamp,
    );
  }

  // Conversion to Mapbox's Position
  dynamic toMapboxPosition() {
    // Implementation depends on the exact Mapbox Position format
    return [longitude, latitude]; // Typically [lng, lat] for Mapbox
  }
}
```

### TÃ­nh nÄƒng cá»§a CustomPosition

- **Loáº¡i bá» xung Ä‘á»™t**: Giáº£i quyáº¿t váº¥n Ä‘á» xung Ä‘á»™t giá»¯a geolocator Position vÃ  Mapbox Position
- **Kháº£ nÄƒng chuyá»ƒn Ä‘á»•i**: Há»— trá»£ chuyá»ƒn Ä‘á»•i qua láº¡i giá»¯a cÃ¡c Ä‘á»‹nh dáº¡ng vá»‹ trÃ­ khÃ¡c nhau
- **Chuáº©n hÃ³a dá»¯ liá»‡u**: Äáº£m báº£o nháº¥t quÃ¡n trong cÃ¡ch sá»­ dá»¥ng dá»¯ liá»‡u vá»‹ trÃ­ trong á»©ng dá»¥ng
- **Má»Ÿ rá»™ng**: Dá»… dÃ ng má»Ÿ rá»™ng vá»›i cÃ¡c thuá»™c tÃ­nh bá»• sung khi cáº§n

### Tá»‘i Æ°u hÃ³a Route Map

- **Xá»­ lÃ½ marker Ä‘á»™ng**: Tá»± Ä‘á»™ng cáº­p nháº­t vá»‹ trÃ­ marker theo GPS
- **Custom marker icons**: Sá»­ dá»¥ng icon tÃ¹y chá»‰nh cho cÃ¡c loáº¡i Ä‘iá»ƒm trÃªn báº£n Ä‘á»“
- **Polyline animation**: Hiá»‡u á»©ng Ä‘Æ°á»ng Ä‘i vá»›i gradient vÃ  animation
- **Turn-by-turn instructions**: HÆ°á»›ng dáº«n chi tiáº¿t cho tá»«ng Ä‘oáº¡n Ä‘Æ°á»ng
- **Multiple route options**: Hiá»ƒn thá»‹ nhiá»u tÃ¹y chá»n tuyáº¿n Ä‘Æ°á»ng vÃ  cho phÃ©p ngÆ°á»i dÃ¹ng chá»n
- **Route optimization**: TÃ­nh toÃ¡n tuyáº¿n Ä‘Æ°á»ng tá»‘i Æ°u vá»›i nhiá»u Ä‘iá»ƒm dá»«ng

### CÃ¡c cáº£i tiáº¿n khÃ¡c

- **Low battery optimization**: Giáº£m táº§n suáº¥t cáº­p nháº­t GPS khi pin yáº¿u
- **Offline map data**: Há»— trá»£ táº£i xuá»‘ng dá»¯ liá»‡u báº£n Ä‘á»“ Ä‘á»ƒ sá»­ dá»¥ng offline
- **Background tracking**: Theo dÃµi vá»‹ trÃ­ ngay cáº£ khi á»©ng dá»¥ng á»Ÿ cháº¿ Ä‘á»™ ná»n
- **Geofencing**: ThÃ´ng bÃ¡o khi tÃ i xáº¿ Ä‘áº¿n gáº§n Ä‘iá»ƒm giao hÃ ng

## Cáº¥u hÃ¬nh dá»± Ã¡n

### Prerequisites

- **Flutter SDK**: 3.32.8 
- **Dart**: 3.8.1
- **Android Studio**: Báº£n má»›i nháº¥t
- **Gradle**: 8.14.3
- **Android SDK**: API 35 (Android 14)

### BÆ°á»›c 1: CÃ i Ä‘áº·t mÃ´i trÆ°á»ng

#### CÃ i Ä‘áº·t Gradle
```bash
# Táº£i Gradle báº£n 8.14.3 tá»« https://gradle.org/releases/
# Giáº£i nÃ©n file zip vÃ o thÆ° má»¥c nhÆ° C:\gradle\gradle-8.14.3
# ThÃªm vÃ o Environment Variables > Path: C:\gradle\gradle-8.14.3\bin
# Kiá»ƒm tra cÃ i Ä‘áº·t
gradle --version
```

#### CÃ i Ä‘áº·t Flutter SDK
```bash
# Táº£i Flutter 3.32.8 tá»« https://docs.flutter.dev/release/archive
# Giáº£i nÃ©n vÃ  thÃªm vÃ o Environment Variables > Path: 
# D:\flutter\bin
# C:\Users\<username>\AppData\Local\Pub\Cache\bin
# Kiá»ƒm tra cÃ i Ä‘áº·t
flutter --version
```

#### CÃ i Ä‘áº·t Android Studio vÃ  SDK
- CÃ i Android Studio, cÃ i extension cho Flutter
- Äá»•i thÆ° má»¥c mÃ¡y áº£o náº¿u háº¿t dung lÆ°á»£ng á»• cá»©ng: 
  `File > Settings > Appearance & Behavior > System Settings > Android SDK > SDK Tools`
- CÃ i Ä‘áº·t cmdline-tools qua SDK Manager náº¿u bá»‹ thiáº¿u
- Cáº¥u hÃ¬nh Android SDK:
```bash
flutter config --android-sdk "D:\Android\Sdk"
flutter doctor --android-licenses
```

### Cáº¥u hÃ¬nh Gradle Wrapper

Sau khi táº£i file `gradle-8.14.3-all.zip` vá», cáº­p nháº­t file `android/gradle/wrapper/gradle-wrapper.properties`:

```properties
distributionBase=GRADLE_USER_HOME
distributionPath=wrapper/dists
zipStoreBase=GRADLE_USER_HOME
zipStorePath=wrapper/dists
distributionUrl=file\:///D:/gradle-8.14.3-all.zip
```

### BÆ°á»›c 2: Setup vÃ  cháº¡y project

#### Clone vÃ  cÃ i Ä‘áº·t dependencies
```bash
cd PROJECT_KTC_2025/driver-app
flutter pub get
```

#### Cáº¥u hÃ¬nh Firebase vÃ  API Keys
- ThÃªm `google-services.json` vÃ o `android/app/` (cÃ³ thá»ƒ loáº¡i bá» trong tÆ°Æ¡ng lai khi backend tÃ­ch há»£p Ä‘áº§y Ä‘á»§)
- Cáº¥u hÃ¬nh Firebase project cho FCM (táº¡m thá»i sá»­ dá»¥ng cho notification, sáº½ chuyá»ƒn sang backend service)
- Äá»•i IP/backend: sá»­a file `lib/data/env/env.dart`
- Firebase Cloud Messaging: Äáº·t Server Key vÃ o `lib/data/services/notification_service.dart` (táº¡m thá»i)
- MapBox: 
  - ÄÄƒng kÃ½ vÃ  láº¥y token tá»« https://account.mapbox.com/
  - Äáº·t token vÃ o `lib/data/env/map_keys.dart`

#### Cháº¡y á»©ng dá»¥ng

```bash
# Khá»Ÿi Ä‘á»™ng thiáº¿t bá»‹ áº£o trong AVD hoáº·c káº¿t ná»‘i thiáº¿t bá»‹ tháº­t (USB debugging)
flutter run

# Hoáº·c build release APK
flutter build apk --release

# CÃ i Ä‘áº·t trá»±c tiáº¿p vÃ o thiáº¿t bá»‹
flutter install
```

### BÆ°á»›c 3: Build APK Ä‘á»ƒ cÃ i Ä‘áº·t trÃªn thiáº¿t bá»‹

#### Build Debug APK (cho development)

```bash
# Build debug APK
flutter build apk --debug

# Hoáº·c sá»­ dá»¥ng script tá»± Ä‘á»™ng (náº¿u cÃ³ lá»—i vá» Ä‘Æ°á»ng dáº«n APK)
.\build_apk.ps1
```

#### Build Release APK (cho production)

```bash
# Clean project trÆ°á»›c khi build
flutter clean
flutter pub get

# Build release APK
flutter build apk --release

# APK sáº½ Ä‘Æ°á»£c táº¡o táº¡i: build/app/outputs/flutter-apk/app-release.apk
```

#### CÃ i Ä‘áº·t APK trÃªn thiáº¿t bá»‹

```bash
# Via ADB (thiáº¿t bá»‹ káº¿t ná»‘i USB)
adb install build/app/outputs/flutter-apk/app-debug.apk

# Hoáº·c copy file APK vÃ o thiáº¿t bá»‹ vÃ  cÃ i Ä‘áº·t thá»§ cÃ´ng
# Äáº£m báº£o enable "Install from Unknown Sources" trÃªn Android
```

### BÆ°á»›c 4: TÃ i khoáº£n test Ä‘á»ƒ Ä‘Äƒng nháº­p

á»¨ng dá»¥ng cÃ³ sáºµn cÃ¡c tÃ i khoáº£n test sau:

#### ğŸš› **TÃ i xáº¿ 1 - Xe táº£i**

- **Email**: `driver@ktc.com`
- **Máº­t kháº©u**: `123456`
- **TÃªn**: Nguyá»…n VÄƒn An
- **Sá»‘ Ä‘iá»‡n thoáº¡i**: +84 901 234 567
- **PhÆ°Æ¡ng tiá»‡n**: Xe táº£i nhá» Hyundai Porter (29A-12345)
- **Táº£i trá»ng**: 1.5 táº¥n

#### ğŸï¸ **TÃ i xáº¿ 2 - Xe mÃ¡y**

- **Email**: `driver2@ktc.com`
- **Máº­t kháº©u**: `123456`
- **TÃªn**: Tráº§n Thá»‹ Lan
- **Sá»‘ Ä‘iá»‡n thoáº¡i**: +84 902 345 678
- **PhÆ°Æ¡ng tiá»‡n**: Xe mÃ¡y Honda Lead (29B1-67890)
- **Táº£i trá»ng**: 30 kg

#### ğŸ“± **CÃ¡ch sá»­ dá»¥ng tÃ i khoáº£n test**

1. Má»Ÿ á»©ng dá»¥ng sau khi cÃ i Ä‘áº·t
2. Chá»n "ÄÄƒng nháº­p"
3. Nháº­p má»™t trong hai tÃ i khoáº£n trÃªn
4. KhÃ¡m phÃ¡ cÃ¡c tÃ­nh nÄƒng: nháº­n Ä‘Æ¡n hÃ ng, xem báº£n Ä‘á»“, cáº­p nháº­t tráº¡ng thÃ¡i giao hÃ ng

> **LÆ°u Ã½**: Hiá»‡n táº¡i app Ä‘ang sá»­ dá»¥ng mock data, khÃ´ng cáº§n káº¿t ná»‘i backend server. Táº¥t cáº£ dá»¯ liá»‡u Ä‘Æ¡n hÃ ng vÃ  thÃ´ng tin tÃ i xáº¿ Ä‘á»u Ä‘Æ°á»£c mÃ´ phá»ng Ä‘á»ƒ demo tÃ­nh nÄƒng.

#### Debug vÃ  Hot Reload

```bash
# Connect device qua USB
adb devices

# Run debug vá»›i hot reload
flutter run --debug

# CÃ¡c lá»‡nh hot reload
r    # Hot reload
R    # Hot restart
q    # Quit
```

---

## ğŸ§ª Testing

### Run tests

```bash
# Unit tests
flutter test

# Integration tests  
flutter test integration_test/
```

### Debug trÃªn device

```bash
# Connect device qua USB
adb devices

# Run debug
flutter run --debug

# Hot reload trong development
r    # Hot reload
R    # Hot restart
q    # Quit
```

---

## ğŸ”§ Troubleshooting

### Common Issues

#### 1. Gradle build fails

```bash
cd android
./gradlew clean
cd ..
flutter clean
flutter pub get
```

#### 2. Permission issues

- Enable USB Debugging
- Allow "Install from Unknown Sources"
- Grant location permissions

#### 3. Firebase khÃ´ng hoáº¡t Ä‘á»™ng (táº¡m thá»i sá»­ dá»¥ng)

- Kiá»ƒm tra `google-services.json`
- Verify Firebase project configuration
- Check FCM token generation

#### 4. Maps khÃ´ng hiá»ƒn thá»‹

```bash
# Kiá»ƒm tra MapBox token
flutter run -v # Ä‘á»ƒ xem lá»—i chi tiáº¿t
```

- Kiá»ƒm tra token MapBox cÃ³ há»£p lá»‡ khÃ´ng
- Verify quyá»n truy cáº­p vá»‹ trÃ­
- Äáº£m báº£o thiáº¿t bá»‹ cÃ³ káº¿t ná»‘i internet

---

## ğŸ“„ License

Copyright Â© 2025 KTC Logistics. All rights reserved.

---

## LiÃªn há»‡ & Há»— trá»£

Náº¿u gáº·p váº¥n Ä‘á» khi cÃ i Ä‘áº·t hoáº·c cháº¡y, hÃ£y má»Ÿ issue trong repository Ä‘á»ƒ Ä‘Æ°á»£c há»— trá»£ nhanh chÃ³ng.
